(function(e){function t(t){for(var o,s,i=t[0],c=t[1],l=t[2],f=0,d=[];f<i.length;f++)s=i[f],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&d.push(n[s][0]),n[s]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);u&&u(t);while(d.length)d.shift()();return a.push.apply(a,l||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],o=!0,i=1;i<r.length;i++){var c=r[i];0!==n[c]&&(o=!1)}o&&(a.splice(t--,1),e=s(s.s=r[0]))}return e}var o={},n={app:0},a=[];function s(t){if(o[t])return o[t].exports;var r=o[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=o,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(r,o,function(t){return e[t]}.bind(null,o));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;a.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"013b":function(e,t,r){"use strict";var o=r("e9fb"),n=r.n(o);n.a},"034f":function(e,t,r){"use strict";var o=r("85ec"),n=r.n(o);n.a},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var o=r("2b0e"),n=r("bc3a"),a=r.n(n),s=r("a7fe"),i=r.n(s),c=r("1dce"),l=r.n(c),u=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[e.loggedIn?e.loggedIn?r("welcome-page",{attrs:{accessToken:e.accessToken}}):e._e():r("login-form")],1)},f=[],d=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"Login Login_error"},[e._m(0),r("form",{staticClass:"Login-Form Form"},[r("div",{staticClass:"Form-Row"},[r("label",{staticClass:"Input"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.form.login,expression:"form.login"}],staticClass:"Input-Control",attrs:{placeholder:"Логин",type:"text"},domProps:{value:e.form.login},on:{blur:function(t){return e.$v.form.login.$touch()},input:function(t){t.target.composing||e.$set(e.form,"login",t.target.value)}}})]),e.$v.form.login.$error?r("div",{staticClass:"Error Login-Error"},[e.$v.form.login.required?e._e():r("p",{staticClass:"Error-Text Error-Text_icon"},[e._v("Поле логин обязательно")])]):e._e()]),r("div",{staticClass:"Form-Row"},[r("label",{staticClass:"Input"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.form.password,expression:"form.password"}],staticClass:"Input-Control",attrs:{placeholder:"Пароль",type:"password"},domProps:{value:e.form.password},on:{blur:function(t){return e.$v.form.password.$touch()},input:function(t){t.target.composing||e.$set(e.form,"password",t.target.value)}}})]),e.$v.form.password.$error?r("div",{staticClass:"Error Login-Error"},[e.$v.form.password.required?e._e():r("p",{staticClass:"Error-Text Error-Text_icon"},[e._v("Поле пароль обязательно")])]):e._e()]),r("div",{staticClass:"Form-Row Form-Row_btnWrap"},[r("button",{staticClass:"Btn Form-Btn Btn_theme_blue",class:{Btn_theme_wait:e.form.loading},attrs:{disabled:e.$v.form.$invalid},on:{click:function(t){return t.preventDefault(),e.handleSubmit(t)}}})]),r("div",{directives:[{name:"show",rawName:"v-show",value:e.form.error,expression:"form.error"}],staticClass:"Form-Row"},[e._m(1)])])])},p=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"Login-Logo Logo"},[o("img",{staticClass:"Logo-Image",attrs:{src:r("9b19"),alt:""}})])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"Error Login-Error"},[r("p",{staticClass:"Error-Text Error-Text_icon"},[e._v("Неверный логин или пароль.")])])}],m=(r("f4b3"),r("bf19"),r("b5ae")),g={name:"LoginForm",data:function(){return{form:{login:"",password:"",error:!1,loading:!1}}},methods:{handleSubmit:function(){var e=this;this.$v.form.$touch(),this.$v.form.$invalid||(this.form.loading=!0,this.axios.post("http://api2.denlam.ru/auth",{"oko-data":{login:this.form.login,password:this.form.password,device_datetime:"Asia/Yekaterinburg"}}).then((function(t){e.form.error=!1,e.form.loading=!1,j.$emit("loginAttempted",{success:!e.form.error,accessToken:t.data.access_token}),console.log(t)})).catch((function(t){console.log(t.toJSON()),e.form.error=!0,e.form.loading=!1})))}},validations:{form:{login:{required:m["required"]},password:{required:m["required"]}}}},v=g,h=(r("013b"),r("2877")),b=Object(h["a"])(v,d,p,!1,null,null,null),_=b.exports,w=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h1",[e._v(e._s(e.greeting))])])},$=[],x=(r("b0c0"),{name:"Welcome",props:{accessToken:{type:String}},data:function(){return{name:""}},methods:{fetchUserData:function(){var e=this;this.axios.get("http://api2.denlam.ru/user/show",{headers:{Authorization:this.accessToken}}).then((function(t){e.name=t.data.name})).catch((function(e){console.log(e)}))}},computed:{greeting:function(){return this.name?"Hello, ".concat(this.name,"!"):""}},created:function(){this.fetchUserData()}}),C=x,y=(r("5823"),Object(h["a"])(C,w,$,!1,null,"f864b6ac",null)),E=y.exports,T={name:"app",components:{"login-form":_,"welcome-page":E},data:function(){return{loggedIn:!1,accessToken:""}},methods:{toggleLogin:function(e){this.loggedIn=e.success,this.accessToken=e.accessToken}},created:function(){var e=this;j.$on("loginAttempted",(function(t){e.toggleLogin(t)}))}},k=T,O=(r("034f"),Object(h["a"])(k,u,f,!1,null,null,null)),L=O.exports;r.d(t,"bus",(function(){return j})),o["a"].use(i.a,a.a),o["a"].use(l.a),o["a"].config.productionTip=!1;var j=new o["a"];new o["a"]({render:function(e){return e(L)}}).$mount("#app")},5823:function(e,t,r){"use strict";var o=r("f165"),n=r.n(o);n.a},"85ec":function(e,t,r){},"9b19":function(e,t,r){e.exports=r.p+"img/logo.f5353338.svg"},e9fb:function(e,t,r){},f165:function(e,t,r){}});
//# sourceMappingURL=app.656f1ae1.js.map